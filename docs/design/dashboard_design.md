# OpenClaw Agent Dashboard - ç³»ç»Ÿè®¾è®¡æ–‡æ¡£

**é¡¹ç›®åç§°**: OpenClaw Agent Dashboard
**ç‰ˆæœ¬**: 1.0
**æ—¥æœŸ**: 2026-02-26

---

## 1. ç³»ç»Ÿæ¶æ„

### 1.1 æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          å‰ç«¯ (Vue 3)                            â”‚
â”‚                      Dashboard UI                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ å·¥ä½è§†å›¾ â”‚ â”‚ çŠ¶æ€é¢æ¿ â”‚ â”‚ äº§å‡ºæŸ¥çœ‹ â”‚ â”‚ æµæ°´çº¿   â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚ HTTP/REST
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       åç«¯ (FastAPI)                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ API å±‚  â”‚ â”‚ æ•°æ®è¯»å– â”‚ â”‚ çŠ¶æ€è®¡ç®— â”‚ â”‚ é”™è¯¯æ£€æµ‹ â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚ æ–‡ä»¶è¯»å–
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      OpenClaw æ–‡ä»¶ç³»ç»Ÿ                           â”‚
â”‚  openclaw.json â”‚ subagents/runs.json â”‚ sessions/*.jsonl â”‚      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 æŠ€æœ¯é€‰å‹

**åç«¯**:
- Python 3.10+
- FastAPI (è½»é‡çº§ Web æ¡†æ¶)
- Pydantic (æ•°æ®éªŒè¯)

**å‰ç«¯**:
- Vue 3 (è½»é‡çº§æ¡†æ¶)
- TypeScript (ç±»å‹å®‰å…¨)
- Vite (å¿«é€Ÿæ„å»º)

**é›†æˆæ–¹å¼**: ç‹¬ç«‹æœåŠ¡ï¼ˆè¯»å– OpenClaw æ–‡ä»¶ç³»ç»Ÿï¼‰

---

## 2. æ¨¡å—è®¾è®¡

### 2.1 åç«¯æ¨¡å—

#### 2.1.1 API å±‚ (api/)

**è·¯ç”±è®¾è®¡**:

```
GET  /api/agents           # è·å–æ‰€æœ‰ Agent åˆ—è¡¨åŠçŠ¶æ€
GET  /api/agents/:id       # è·å–å•ä¸ª Agent è¯¦æƒ…
GET  /api/subagents        # è·å–å½“å‰å­ä»£ç†è¿è¡Œ
GET  /api/workflow         # è·å–é¡¹ç›®æµæ°´çº¿çŠ¶æ€
GET  /api/api-status       # è·å– API çŠ¶æ€
```

#### 2.1.2 æ•°æ®è¯»å–å±‚ (data/)

**æ¨¡å—èŒè´£**:
- `config_reader.py` - è¯»å– openclaw.json
- `subagent_reader.py` - è¯»å– subagents/runs.json
- `session_reader.py` - è¯»å– sessions/*.jsonl
- `log_reader.py` - è¯»å– model-failures.log

#### 2.1.3 çŠ¶æ€è®¡ç®—å±‚ (status/)

**æ¨¡å—èŒè´£**:
- `status_calculator.py` - è®¡ç®— Agent çŠ¶æ€
- `error_detector.py` - æ£€æµ‹ API å¼‚å¸¸
- `workflow_tracker.py` - è¿½è¸ªé¡¹ç›®æµæ°´çº¿

### 2.2 å‰ç«¯æ¨¡å—

#### 2.2.1 é¡µé¢ç»„ä»¶ (pages/)

- `Dashboard.vue` - ä¸»çœ‹æ¿é¡µé¢
- `AgentDetail.vue` - Agent è¯¦æƒ…é¢æ¿

#### 2.2.2 ç»„ä»¶ (components/)

- `AgentCard.vue` - Agent å·¥ä½å¡ç‰‡
- `StatusIndicator.vue` - çŠ¶æ€æŒ‡ç¤ºå™¨
- `WorkflowView.vue` - æµæ°´çº¿è§†å›¾
- `ApiStatusPanel.vue` - API çŠ¶æ€é¢æ¿

#### 2.2.3 API å®¢æˆ·ç«¯ (api/)

- `agents.ts` - Agent API
- `subagents.ts` - Subagent API
- `workflow.ts` - Workflow API
- `api-status.ts` - API Status API

---

## 3. æ•°æ®æ¨¡å‹

### 3.1 Agent çŠ¶æ€

```typescript
interface AgentStatus {
  id: string;           // Agent ID
  name: string;         // Agent åç§°
  role: string;         // Agent è§’è‰²
  status: 'idle' | 'working' | 'down';
  currentTask?: string; // å½“å‰ä»»åŠ¡æ‘˜è¦
  lastActiveAt?: number;// æœ€åæ´»è·ƒæ—¶é—´
  errors?: ErrorInfo[]; // é”™è¯¯åˆ—è¡¨
}

interface ErrorInfo {
  type: string;        // é”™è¯¯ç±»å‹ï¼š429/rate-limit/token/timeout
  message: string;      // é”™è¯¯æ¶ˆæ¯
  timestamp: number;   // æ—¶é—´æˆ³
}
```

### 3.2 Subagent Run

```typescript
interface SubagentRun {
  runId: string;
  agentId: string;
  task: string;
  startedAt: number;
  endedAt: number | null;
  outcome: 'ok' | 'failed';
}
```

### 3.3 Workflow çŠ¶æ€

```typescript
interface WorkflowStatus {
  stages: {
    prd: 'pending' | 'in-progress' | 'done';
    design: 'pending' | 'in-progress' | 'done';
    dev: 'pending' | 'in-progress' | 'done';
    qa: 'pending' | 'in-progress' | 'done';
    deploy: 'pending' | 'in-progress' | 'done';
  };
  currentStage: string;
  artifacts: string[];
}
```

### 3.4 API çŠ¶æ€

```typescript
interface ApiStatus {
  provider: string;     // æœåŠ¡å•†ï¼šzhipu/qwen/dashscope
  model: string;        // æ¨¡å‹ï¼šglm-4.7/coder-model
  status: 'healthy' | 'degraded' | 'down';
  lastError?: ErrorInfo;
  estimatedTpm?: number; // TPM ä¼°ç®—
}
```

---

## 4. çŠ¶æ€è®¡ç®—é€»è¾‘

### 4.1 Agent çŠ¶æ€åˆ¤å®š

**ç©ºé—² (idle)**:
```python
def is_idle(agent_id: str) -> bool:
    # æ— æ´»è·ƒ subagent run
    has_active = has_active_subagent_run(agent_id)
    if has_active:
        return False
    
    # æœ€è¿‘5åˆ†é’Ÿæ— æ´»åŠ¨
    last_active = get_last_active_time(agent_id)
    if last_active and (now() - last_active) < 300:
        return False
    
    return True
```

**å·¥ä½œä¸­ (working)**:
```python
def is_working(agent_id: str) -> bool:
    return has_active_subagent_run(agent_id)
```

**å¼‚å¸¸ (down)**:
```python
def is_down(agent_id: str) -> bool:
    recent_messages = get_recent_messages(agent_id, minutes=5)
    for msg in recent_messages:
        if msg.stopReason == 'error':
            error_msg = msg.errorMessage or ''
            if contains_error_keywords(error_msg):
                return True
    return False

def contains_error_keywords(msg: str) -> bool:
    keywords = ['429', 'rate limit', 'token', 'timeout', 'è¶…æ—¶', 'ä½™é¢ä¸è¶³']
    return any(kw in msg.lower() for kw in keywords)
```

### 4.2 TPM ä¼°ç®—

```python
def estimate_tpm(provider: str, model: str, window: int = 5) -> int:
    """
    ä¼°ç®—æœ€è¿‘ N åˆ†é’Ÿçš„ TPM
    """
    runs = get_recent_runs(provider, model, minutes=window)
    total_tokens = sum(run.totalTokens for run in runs)
    tpm = total_tokens // window
    return tpm
```

---

## 5. å‰ç«¯ UI è®¾è®¡

### 5.1 ä¸»å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  OpenClow Agent Dashboard                    [è‡ªåŠ¨åˆ·æ–° 10s] âš™ï¸  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                  â”‚
â”‚    â”‚ ä¸» Agent â”‚  â† å±…ä¸­é ä¸Šï¼ŒæŒ‡æŒ¥ä¸­å¿ƒ                          â”‚
â”‚    â”‚  ğŸŸ¢     â”‚                                                  â”‚
â”‚    â”‚   PM    â”‚                                                  â”‚
â”‚    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                                                  â”‚
â”‚         â”‚ æ´¾å‘                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”                                       â”‚
â”‚   â–¼     â–¼     â–¼        â–¼                                       â”‚
â”‚ â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚ â”‚Analâ”‚ â”‚Archâ”‚ â”‚ Dev  â”‚ â”‚Test  â”‚  â† å­ Agent å·¥ä½               â”‚
â”‚ â”‚ ğŸŸ¡ â”‚ â”‚ ğŸŸ¢ â”‚ â”‚  ğŸ”´  â”‚ â”‚  ğŸŸ¢  â”‚                               â”‚
â”‚ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚                                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  é¡¹ç›®æµæ°´çº¿                                                       â”‚
â”‚  [PRD] â†’ [è®¾è®¡] â†’ [å¼€å‘] â†’ [QA] â†’ [éƒ¨ç½²]                         â”‚
â”‚    âœ…       âœ…       ğŸ”„       â³       â³                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  API çŠ¶æ€                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ Provider/Model  â”‚ çŠ¶æ€      â”‚ æœ€è¿‘é”™è¯¯     â”‚               â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤               â”‚
â”‚  â”‚ zhipu/glm-4.7   â”‚ ğŸŸ¢ OK      â”‚ -            â”‚               â”‚
â”‚  â”‚ qwen/coder      â”‚ ğŸ”´ 429     â”‚ 2åˆ†é’Ÿå‰      â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 Agent å¡ç‰‡

```vue
<AgentCard>
  <Avatar>ğŸ¤–</Avatar>
  <Name>DevOps Agent</Name>
  <StatusIndicator color="yellow">ğŸ”„ å·¥ä½œä¸­</StatusIndicator>
  <CurrentTask>å®ç°æ ¸å¿ƒé€»è¾‘...</CurrentTask>
  <LastActive>2åˆ†é’Ÿå‰</LastActive>
</AgentCard>
```

### 5.3 è¯¦æƒ…é¢æ¿

```vue
<AgentDetailPanel>
  <Section title="æœ€è¿‘è¾“å‡º">
    <MessageList>
      <Message>å·²ç”Ÿæˆ main.py</Message>
      <Message>æ­£åœ¨ç”Ÿæˆ validator.py</Message>
    </MessageList>
  </Section>
  
  <Section title="å·¥å…·è°ƒç”¨">
    <ToolCall>
      <Type>write</Type>
      <Path>/path/to/file</Path>
      <Status>âœ…</Status>
    </ToolCall>
  </Section>
  
  <Section title="é”™è¯¯">
    <Error type="429" message="Rate limit exceeded" />
  </Section>
</AgentDetailPanel>
```

---

## 6. å®ç°é˜¶æ®µ

### é˜¶æ®µ 1: MVP (å¿…é¡»)

**åç«¯**:
- [x] API è·¯ç”±å®šä¹‰
- [x] æ•°æ®è¯»å–å±‚
- [x] çŠ¶æ€è®¡ç®—é€»è¾‘

**å‰ç«¯**:
- [x] ä¸»é¡µé¢å¸ƒå±€
- [x] Agent å·¥ä½å¡ç‰‡
- [x] çŠ¶æ€æŒ‡ç¤ºå™¨
- [x] è¯¦æƒ…é¢æ¿

**é›†æˆ**:
- [x] API è°ƒç”¨
- [x] è‡ªåŠ¨åˆ·æ–°

### é˜¶æ®µ 2: å¢å¼º (å¯é€‰)

- [x] é¡¹ç›®æµæ°´çº¿
- [x] API çŠ¶æ€é¢æ¿
- [x] å“åº”å¼å¸ƒå±€
- [x] è®¾ç½®é¡µé¢

---

## 7. éƒ¨ç½²æ–¹æ¡ˆ

### 7.1 å¼€å‘ç¯å¢ƒ

```bash
# åç«¯
cd backend
pip install -r requirements.txt
uvicorn main:app --reload --port 8000

# å‰ç«¯
cd frontend
npm install
npm run dev
```

### 7.2 ç”Ÿäº§ç¯å¢ƒ

```bash
# åç«¯ (FastAPI + Gunicorn)
gunicorn main:app -w 4 -k uvicorn.workers.UvicornWorker -b 0.0.0.0:8000

# å‰ç«¯ (Nginx)
npm run build
# nginx é™æ€æ–‡ä»¶æ‰˜ç®¡
```

---

*è®¾è®¡å®Œæˆ: 2026-02-26*
