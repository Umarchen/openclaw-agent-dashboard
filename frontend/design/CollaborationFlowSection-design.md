# åä½œæµç¨‹ç»„ä»¶ - ç¾è§‚ä¼˜åŒ–è®¾è®¡æ–‡æ¡£

**æ–‡ä»¶**: `CollaborationFlowSection.vue`  
**æ—¥æœŸ**: 2026-02-27  
**ç›®æ ‡**: é’ˆå¯¹å¸ƒå±€ã€é¢œè‰²ã€å­—ä½“ã€å›¾æ ‡ã€é—´è·ã€å›¾ä¾‹ã€å“åº”å¼ã€åŠ¨æ•ˆç­‰ 8 ä¸ªç»´åº¦æå‡ºæ”¹è¿›å»ºè®®

---

## ä¸€ã€å½“å‰å®ç°æ¦‚è§ˆ

### ç°æœ‰ç»“æ„
- **å¸ƒå±€**: å·¦ä¾§ Agentsï¼ˆè€ K ä¸Šã€å­ Agents ä¸‹ï¼‰+ ä»»åŠ¡/å·¥å…·è¡Œ + å³ä¾§æ¨¡å‹åˆ—
- **è¿æ¥**: SVG è´å¡å°”æ›²çº¿ï¼Œå§”æ‰˜è¾¹/æ¨¡å‹è¾¹æœ‰å…‰çƒåŠ¨ç”»
- **çŠ¶æ€**: è¿æ¥æŒ‡ç¤ºå™¨ï¼ˆå·²è¿æ¥/è¿æ¥ä¸­/æœªè¿æ¥ï¼‰ï¼ŒAgent çŠ¶æ€ï¼ˆç©ºé—²/å·¥ä½œä¸­/å¼‚å¸¸ï¼‰
- **å›¾ä¾‹**: åº•éƒ¨æ¨ªæ’ï¼Œå« Agent ç±»å‹ä¸é¢œè‰²

### ç°æœ‰ä¼˜ç‚¹
- å·²æœ‰è¿æ¥çŠ¶æ€é¢œè‰²ï¼ˆç»¿/é»„/çº¢ï¼‰
- å·²æœ‰ Agent çŠ¶æ€åœ†ç‚¹
- å·²æœ‰å…‰çƒæ²¿è·¯å¾„åŠ¨ç”»
- å·²æœ‰æ¨¡å‹è°ƒç”¨å…‰çƒä¸²

---

## äºŒã€é—®é¢˜åˆ†æä¸æ”¹è¿›å»ºè®®

### 1. å¸ƒå±€ç»“æ„

| é—®é¢˜ | å½“å‰è¡¨ç° | æ”¹è¿›å»ºè®® |
|------|----------|----------|
| ä¸»æ¬¡å±‚çº§ä¸å¤Ÿ | è€ K ä¸å­ Agents è§†è§‰æƒé‡ç›¸è¿‘ | è€ K å¡ç‰‡åŠ å¤§ï¼ˆå¦‚ 1.2xï¼‰ï¼ŒåŠ ã€ŒPMã€è§’æ ‡æˆ–è¾¹æ¡†é«˜äº® |
| æµå‘ä¸æ¸…æ™° | ç®­å¤´ä¸ºè´å¡å°”æ›²çº¿ï¼Œæ— æ–¹å‘ç®­å¤´ | åœ¨ path æœ«ç«¯æ·»åŠ ç®­å¤´ markerï¼Œæˆ–ä½¿ç”¨ `marker-end="url(#arrowhead)"` |
| åŒºåŸŸæ„Ÿå¼± | èŠ‚ç‚¹æ•£è½åœ¨ç°è‰²èƒŒæ™¯ä¸Š | ç”¨æµ…è‰²èƒŒæ™¯å—åˆ’åˆ†ï¼šå·¦ä¾§ã€ŒAgent åŒºã€ã€ä¸­é—´ã€Œä»»åŠ¡åŒºã€ã€å³ä¾§ã€Œæ¨¡å‹åŒºã€ |
| æ³³é“æ„Ÿä¸è¶³ | æ— æ˜ç¡®æ³³é“ | å¯é€‰ï¼šç”¨æ°´å¹³è™šçº¿åˆ†éš”ã€ŒPM å±‚ã€ã€Œæ‰§è¡Œå±‚ã€ã€Œæ¨¡å‹å±‚ã€ |

**å…·ä½“å®ç°**:
```css
/* åŒºåŸŸèƒŒæ™¯å— */
.flow-canvas::before {
  content: '';
  position: absolute;
  left: 0; top: 0;
  width: 1400px; height: 100%;
  background: linear-gradient(90deg,
    rgba(74, 158, 255, 0.03) 0%,
    transparent 45%,
    rgba(139, 92, 246, 0.03) 100%);
  pointer-events: none;
  border-radius: 8px;
}
```

```html
<!-- SVG ç®­å¤´å®šä¹‰ -->
<defs>
  <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
    <polygon points="0 0, 10 3.5, 0 7" fill="currentColor" />
  </marker>
</defs>
<path ... marker-end="url(#arrowhead)" />
```

---

### 2. é¢œè‰²ä½¿ç”¨

| é—®é¢˜ | å½“å‰è¡¨ç° | æ”¹è¿›å»ºè®® |
|------|----------|----------|
| çŠ¶æ€é¢œè‰²å·²æœ‰ | è¿æ¥: ç»¿/é»„/çº¢ï¼›Agent: è“/ç»¿/çº¢ | ä¿æŒï¼Œå¯å¢åŠ ã€Œç¦»çº¿ã€ç°è‰² `#94a3b8` |
| æ¨¡å‹å‡çº§/é™çº§ | æ— åŒºåˆ† | æ­£å‘ï¼ˆprimaryâ†’fallbackï¼‰ç”¨è“è‰²ï¼›é™çº§ï¼ˆå¦‚ 429 åï¼‰ç”¨æ©™è‰² `#f97316` |
| å›¾ä¾‹ä¸å®ç‰©ä¸€è‡´ | å›¾ä¾‹é¢œè‰²ä¸ AGENT_COLORS ä¸€è‡´ | ç¡®è®¤å›¾ä¾‹ä»…å±•ç¤ºå½“å‰è§†å›¾ä¸­çš„ Agentï¼Œé¿å…å†—ä½™ |

**å…·ä½“å®ç°**:
```typescript
// æ¨¡å‹è¾¹é¢œè‰²ï¼šæ ¹æ®æ˜¯å¦é™çº§
const getModelEdgeColor = (edge: CollaborationEdge) => {
  if (edge.metadata?.isFallback) return '#f97316'  // é™çº§
  return '#4a9eff'  // æ­£å¸¸
}
```

---

### 3. å­—ä½“ä¸ä¿¡æ¯å±‚çº§

| é—®é¢˜ | å½“å‰è¡¨ç° | æ”¹è¿›å»ºè®® |
|------|----------|----------|
| è§’è‰²åç§° | AgentCard å†… 1.2rem | æå‡è‡³ 1.125rem~1.25remï¼ŒåŠ ç²— 600 |
| çŠ¶æ€ | å°å­— + åœ†ç‚¹ | çŠ¶æ€ç”¨åœ†è§’æ ‡ç­¾ `pill` æ ·å¼ï¼Œå¦‚ `padding: 2px 8px; border-radius: 12px` |
| æ¨¡å‹ç‰ˆæœ¬ | æ™®é€šå­—ä½“ | ç”¨ç­‰å®½å­—ä½“ `font-family: ui-monospace, monospace`ï¼Œå¦‚ `glm-4.7` |
| ç®­å¤´æ–‡æœ¬ | æ—  | æ¨¡å‹è¾¹å¯åŠ  `glm-4.7 â†’ glm-5` å°æ ‡ç­¾ï¼Œç”¨å›¾æ ‡ç®­å¤´ä»£æ›¿çº¯æ–‡æœ¬ |

**å…·ä½“å®ç°**:
```css
/* è§’è‰²åç§° */
.agent-card .name {
  font-size: 1.125rem;
  font-weight: 600;
  letter-spacing: 0.02em;
}

/* çŠ¶æ€æ ‡ç­¾ */
.status-pill {
  display: inline-flex;
  align-items: center;
  padding: 2px 8px;
  border-radius: 12px;
  font-size: 0.75rem;
  font-weight: 500;
}
.status-pill.idle { background: #dcfce7; color: #166534; }
.status-pill.working { background: #dbeafe; color: #1d4ed8; }
.status-pill.down { background: #fee2e2; color: #991b1b; }

/* æ¨¡å‹ ID */
.model-primary, .model-fallbacks {
  font-family: ui-monospace, 'Cascadia Code', monospace;
  font-size: 0.8rem;
}
```

---

### 4. å›¾æ ‡ä¸å›¾å½¢å…ƒç´ 

| é—®é¢˜ | å½“å‰è¡¨ç° | æ”¹è¿›å»ºè®® |
|------|----------|----------|
| Agent å›¾æ ‡ | ä½¿ç”¨ emojiï¼ˆğŸ‘¨â€ğŸ’¼ğŸ“ŠğŸ—ï¸ğŸ’»ï¼‰ | å¯ä¿ç•™ï¼Œæˆ–æ”¹ç”¨ SVG å›¾æ ‡ï¼ˆå¦‚ Lucideï¼‰ç»Ÿä¸€é£æ ¼ |
| çŠ¶æ€æŒ‡ç¤º | å·²æœ‰åœ†ç‚¹ | è¿æ¥ä¸­åŠ è„‰åŠ¨åŠ¨ç”» |
| ç®­å¤´ | çº¯ pathï¼Œæ— ç®­å¤´ | æ·»åŠ  SVG marker ç®­å¤´ |
| æ¨¡å‹è¾¹ | æœ‰å…‰çƒ | å¯åŠ å°æ ‡ç­¾å¦‚ `glm-4.7` åœ¨è¾¹ä¸­ç‚¹ |

**å…·ä½“å®ç°**:
```css
/* è¿æ¥ä¸­è„‰åŠ¨ */
.connection-indicator.connecting .indicator-dot {
  animation: pulse 1.5s ease-in-out infinite;
}
@keyframes pulse {
  0%, 100% { opacity: 1; transform: scale(1); }
  50% { opacity: 0.5; transform: scale(1.2); }
}
```

---

### 5. ç©ºç™½ä¸é—´è·

| é—®é¢˜ | å½“å‰è¡¨ç° | æ”¹è¿›å»ºè®® |
|------|----------|----------|
| å¡ç‰‡å†…è¾¹è· | AgentCard padding 1.5rem | ä¿æŒæˆ–ç•¥å¢åˆ° 1.25rem~1.5rem |
| èŠ‚ç‚¹é—´è· | rowGap 180px, agentColGap 150px | èŠ‚ç‚¹é—´è‡³å°‘ 24pxï¼ŒåŒºåŸŸé—´ 32px+ |
| å¡ç‰‡é˜´å½± | 0 2px 4px | å¯æ”¹ä¸º `0 2px 8px rgba(0,0,0,0.06)` æ›´æŸ”å’Œ |
| è¾¹æ¡† | 2px solid #e5e7eb | ä¿æŒï¼Œhover æ—¶ `border-color: #4a9eff` |

**å…·ä½“å®ç°**:
```css
.flow-node {
  /* å¢åŠ å‘¼å¸æ„Ÿ */
  margin: 2px;  /* é¿å…è´´è¾¹ */
}

.flow-legend {
  gap: 1.25rem;
  padding: 1rem 0;
}
```

---

### 6. å›¾ä¾‹è®¾è®¡

| é—®é¢˜ | å½“å‰è¡¨ç° | æ”¹è¿›å»ºè®® |
|------|----------|----------|
| ä½ç½® | åº•éƒ¨æ¨ªæ’ï¼Œborder-top åˆ†éš” | æ”¹ä¸ºå³ä¸‹è§’æµ®åŠ¨ï¼Œæˆ–å·¦ä¸Šè§’å°é¢æ¿ |
| ä¸å†…å®¹è„±èŠ‚ | å›¾ä¾‹å›ºå®šå±•ç¤ºæ‰€æœ‰ Agent | ä»…å±•ç¤ºå½“å‰è§†å›¾ä¸­å‡ºç°çš„ Agent |
| è§†è§‰å¹²æ‰° | ç™½åº• | åŠé€æ˜èƒŒæ™¯ `background: rgba(255,255,255,0.9)` æˆ– `rgba(248,250,252,0.95)` |

**å…·ä½“å®ç°**:
```vue
<!-- åŠ¨æ€å›¾ä¾‹ï¼šä»…æ˜¾ç¤ºå½“å‰èŠ‚ç‚¹ä¸­çš„ Agent -->
<div class="flow-legend flow-legend-floating">
  <div v-for="aid in legendAgentIds" :key="aid" class="legend-item">
    <span class="legend-dot" :style="{ background: getAgentColor(aid) }"></span>
    <span>{{ getAgentName(aid) }}</span>
  </div>
  <div class="legend-item">
    <span class="legend-dot active"></span>
    <span>æ´»è·ƒ</span>
  </div>
</div>
```

```css
.flow-legend-floating {
  position: absolute;
  bottom: 1rem;
  right: 1rem;
  display: flex;
  flex-wrap: wrap;
  gap: 0.75rem;
  padding: 0.75rem 1rem;
  background: rgba(255, 255, 255, 0.92);
  border-radius: 8px;
  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
  font-size: 0.8rem;
  z-index: 10;
}
```

---

### 7. å“åº”å¼

| é—®é¢˜ | å½“å‰è¡¨ç° | æ”¹è¿›å»ºè®® |
|------|----------|----------|
| å›ºå®šç”»å¸ƒ | 2000Ã—950px å›ºå®š | ä½¿ç”¨ `min-width` + `overflow: auto`ï¼Œå°å±æ—¶å…è®¸æ¨ªå‘æ»šåŠ¨ |
| å¡ç‰‡æ¢è¡Œ | æ—  | çª„å±æ—¶å­ Agents æ”¹ä¸º 2 åˆ—æˆ–å‚ç›´å †å  |
| ç®­å¤´ | æ°´å¹³/å‚ç›´æ›²çº¿ | å°å±æ—¶å¯ç®€åŒ–è·¯å¾„ï¼Œæˆ–éšè—éƒ¨åˆ†è¾¹æ ‡ç­¾ |
| å›¾ä¾‹ | æ¨ªæ’ wrap | å°å±æ—¶ç¼©å°å­—ä½“ã€å‡å°‘ gap |

**å…·ä½“å®ç°**:
```css
@media (max-width: 1024px) {
  .flow-canvas {
    min-width: 800px;  /* ä¿è¯å¯æ»šåŠ¨ */
  }
  .flow-node.agent-card-wrapper {
    /* å­ Agent å¡ç‰‡å¯ç•¥ç¼©å° */
    --agent-card-scale: 0.9;
  }
}

@media (max-width: 640px) {
  .flow-legend-floating {
    bottom: 0.5rem;
    right: 0.5rem;
    padding: 0.5rem 0.75rem;
    font-size: 0.7rem;
  }
}
```

---

### 8. åŠ¨æ•ˆä¸äº¤äº’

| é—®é¢˜ | å½“å‰è¡¨ç° | æ”¹è¿›å»ºè®® |
|------|----------|----------|
| è¿æ¥ä¸­çŠ¶æ€ | ä»…é¢œè‰²å˜åŒ– | æ·»åŠ è„‰åŠ¨/æ—‹è½¬åŠ¨ç”» |
| å…‰çƒ | å·²æœ‰æ²¿è·¯å¾„åŠ¨ç”» | ä¿æŒï¼Œå¯å¾®è°ƒ `dur` æˆ– `repeatCount` |
| ç®­å¤´æµåŠ¨ | æ—  | å¯é€‰ï¼šæ´»è·ƒè¾¹åŠ  `stroke-dasharray` åŠ¨ç”»ï¼Œè¡¨ç¤ºæ•°æ®æµåŠ¨ |
| å¡ç‰‡ hover | æœ‰ translateY + shadow | ä¿æŒï¼Œå¯åŠ  `transition: 0.2s ease` |

**å…·ä½“å®ç°**:
```css
/* æ´»è·ƒè¾¹æµåŠ¨æ„Ÿ */
.edge-path.active {
  stroke-dasharray: 8 4;
  animation: flow 1s linear infinite;
}
@keyframes flow {
  to { stroke-dashoffset: -12; }
}
```

```css
/* è¿æ¥ä¸­æ—‹è½¬ */
.connection-indicator.connecting .indicator-dot {
  animation: spin 2s linear infinite;
}
```

---

## ä¸‰ã€å®æ–½ä¼˜å…ˆçº§

| ä¼˜å…ˆçº§ | é¡¹ç›® | å·¥ä½œé‡ | å½±å“ |
|--------|------|--------|------|
| P0 | ç®­å¤´æ–¹å‘ï¼ˆmarker-endï¼‰ | å° | æµå‘æ¸…æ™° |
| P0 | è¿æ¥ä¸­è„‰åŠ¨åŠ¨ç”» | å° | çŠ¶æ€æ›´ç›´è§‚ |
| P1 | å›¾ä¾‹æµ®åŠ¨ + åŠ¨æ€å±•ç¤º | ä¸­ | å‡å°‘å¹²æ‰°ã€æ›´å‡†ç¡® |
| P1 | åŒºåŸŸèƒŒæ™¯å— | å° | ä¸»æ¬¡åˆ†æ˜ |
| P2 | çŠ¶æ€ pill æ ·å¼ | å° | ä¿¡æ¯å±‚çº§ |
| P2 | æ¨¡å‹ ID ç­‰å®½å­—ä½“ | å° | å¯è¯»æ€§ |
| P3 | å“åº”å¼å¸ƒå±€è°ƒæ•´ | ä¸­ | å¤šç«¯ä½“éªŒ |
| P3 | æ´»è·ƒè¾¹æµåŠ¨åŠ¨ç”» | å° | è§†è§‰åé¦ˆ |

---

## å››ã€è®¾è®¡è§„èŒƒé€ŸæŸ¥

### é¢œè‰²
- ä¸»è‰²: `#4a9eff`
- æˆåŠŸ/ç©ºé—²: `#22c55e` / `#166534`
- è­¦å‘Š/è¿æ¥ä¸­: `#f59e0b` / `#92400e`
- é”™è¯¯: `#ef4444` / `#991b1b`
- é™çº§: `#f97316`
- ä¸­æ€§: `#64748b`, `#94a3b8`, `#e5e7eb`

### å­—ä½“
- æ ‡é¢˜: 1.25rem, 600
- è§’è‰²å: 1.125rem, 600
- æ­£æ–‡: 0.9rem, 400
- è¾…åŠ©: 0.8rem, 500
- æ¨¡å‹ ID: 0.8rem, ui-monospace

### é—´è·
- å¡ç‰‡å†…è¾¹è·: 1rem~1.5rem
- èŠ‚ç‚¹é—´è·: â‰¥24px
- åŒºåŸŸé—´è·: â‰¥32px

### åœ†è§’
- å¡ç‰‡: 8px
- æ ‡ç­¾ pill: 12px
- å›¾ä¾‹æµ®å±‚: 8px

---

## äº”ã€éªŒæ”¶æ ‡å‡†

- [ ] ç®­å¤´æœ‰æ˜ç¡®æ–¹å‘
- [ ] è¿æ¥ä¸­çŠ¶æ€æœ‰è„‰åŠ¨/æ—‹è½¬åŠ¨ç”»
- [ ] å›¾ä¾‹ä»…å±•ç¤ºå½“å‰è§†å›¾ä¸­çš„ Agentï¼Œä¸”ä½ç½®ä¸é®æŒ¡ä¸»å†…å®¹
- [ ] è§’è‰²åç§°ã€çŠ¶æ€ã€æ¨¡å‹ä¿¡æ¯å±‚çº§æ¸…æ™°
- [ ] çª„å±ä¸‹å¯æ¨ªå‘æ»šåŠ¨ï¼Œå¸ƒå±€ä¸å´©
- [ ] æ´»è·ƒè¾¹æˆ–å…‰çƒæœ‰é€‚åº¦åŠ¨æ•ˆï¼Œä¸å–§å®¾å¤ºä¸»
